
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor de L√≠nea de Tiempo de Logs</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üìä Visor de L√≠nea de Tiempo de Logs de Windows</h1>
            <div class="header-actions">
                <button id="loadFileBtn" class="btn btn-primary">
                    üìÅ Cargar Archivo de Log
                </button>
                <button id="exportJsonBtn" class="btn btn-primary">
                    üíæ Exportar a JSON
                </button>
                <button id="helpBtn" class="btn btn-info">
                    ‚ÑπÔ∏è Comandos de B√∫squeda
                </button>
                <button id="clearAllBtn" class="btn btn-secondary">
                    üóëÔ∏è Limpiar Todo
                </button>
                <button id="translate" class="btn-translate">
                    <img src="img/translate.png" alt="traducir">
                </button>
            </div>
        </header>

        <!-- Stats Section -->
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-label">Archivos cargados:</span>
                <span id="filesCount" class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total de eventos:</span>
                <span id="eventsCount" class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Eventos visibles:</span>
                <span id="visibleEventsCount" class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Rango de fechas:</span>
                <span id="dateRange" class="stat-value">-</span>
            </div>
        </div>

        <!-- Filters Section -->
        <div class="filters-section">
            <div class="filter-group filter-group-wide">
                <label for="searchInput">üîç Buscar (usa comandos: ID:1000, MSG:texto, NIVEL:error):</label>
                <div class="search-wrapper">
                    <input type="text" id="searchInput" placeholder="Escribe aqu√≠ o usa comandos...">
                    <button id="searchButton" class="btn-search">üîé</button>
                </div>
            </div>
            
            <div class="filter-group">
                <label for="sortLevel">Ordenar por Nivel de Evento:</label>
                <select id="sortLevel">
                    <option value="tod">Todos</option>
                    <option value="adv">Advertencia</option>
                    <option value="cri">Cr√≠tico</option>
                    <option value="err">Error</option>
                    <option value="det">Detallado</option>
                    <option value="inf">Informaci√≥n</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="sortOrder">Ordenar por Fecha:</label>
                <select id="sortOrder">
                    <option value="asc">M√°s antiguo primero</option>
                    <option value="desc">M√°s reciente primero</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="sortId">Ordenar por ID:</label>
                <select id="sortId">
                    <option value="">Sin filtro</option>
                    <option value="asc">Ascendente</option>
                    <option value="desc">Descendente</option>
                </select>
            </div>
        </div>

        <!-- Main Content: Sidebar + Timeline -->
        <div class="main-content">
            <!-- Files Sidebar -->
            <aside id="filesSidebar" class="files-sidebar hidden">
                <div class="sidebar-header">
                    <h3>üìÇ Archivos</h3>
                    <div class="sidebar-actions">
                        <button id="selectAllFilesBtn" class="btn-mini" title="Seleccionar todos">‚úî</button>
                        <button id="deselectAllFilesBtn" class="btn-mini" title="Deseleccionar todos">‚úó</button>
                    </div>
                </div>
                <div id="filesList" class="files-list">
                    <!-- Los checkboxes se generar√°n din√°micamente aqu√≠ -->
                </div>
            </aside>

            <!-- Timeline Section -->
            <div class="timeline-wrapper">
                <div class="timeline-container">
                    <div id="emptyState" class="empty-state">
                        <div class="empty-icon">üìÑ</div>
                        <h2>No hay eventos cargados</h2>
                        <p>Haz clic en "Cargar Archivo de Log" para comenzar</p>
                    </div>
                    <div id="timeline" class="timeline"></div>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="spinner"></div>
            <p>Procesando archivo...</p>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpOverlay" class="confirm-overlay hidden">
        <div class="help-modal">
            <h2>üìñ Comandos de B√∫squeda</h2>
            <p>Puedes usar estos comandos en la barra de b√∫squeda:</p>
            <div class="help-commands">
                <div class="help-command">
                    <strong>ID:1000</strong>
                    <span>Buscar por Event ID espec√≠fico</span>
                </div>
                <div class="help-command">
                    <strong>MSG:error conexi√≥n</strong>
                    <span>Buscar texto en mensajes</span>
                </div>
                <div class="help-command">
                    <strong>NIVEL:error</strong>
                    <span>Filtrar por nivel (error, warning, info, critical, detailed)</span>
                </div>
                <div class="help-command">
                    <strong>texto normal</strong>
                    <span>Sin comando, busca en todos los mensajes</span>
                </div>
            </div>
            <div class="help-examples">
                <h3>Ejemplos:</h3>
                <ul>
                    <li><code>ID:4624</code> - Eventos con ID 4624</li>
                    <li><code>MSG:failed login</code> - Mensajes con "failed login"</li>
                    <li><code>NIVEL:critical</code> - Solo eventos cr√≠ticos</li>
                </ul>
            </div>
            <button id="helpBtnClose" class="btn-confirm-no">Cerrar</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmOverlay" class="confirm-overlay hidden">
        <div class="confirm-modal">
            <p id="confirmMessage">¬øEst√°s seguro?</p>
            <div class="confirm-buttons">
                <button id="confirmBtnYes" class="btn-confirm-yes">S√≠, borrar</button>
                <button id="confirmBtnNo" class="btn-confirm-no">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="notificationOverlay" class="confirm-overlay hidden">
        <div class="confirm-modal">
            <p id="notificationMessage">Mensaje</p>
            <div class="confirm-buttons">
                <button id="notificationBtnOk" class="btn-confirm-no">Aceptar</button>
            </div>
        </div>
    </div>
    
    <script src="js/neutralino.js"></script>
    <script src="js/parsers.js"></script>
    <script src="js/main.js"></script>
    <script src="js/translate.js"></script>
    
    <!-- Script para verificar que Neutralino est√° cargado -->
    <script>
        window.addEventListener('load', function() {
            if (typeof Neutralino === 'undefined') {
                console.error('NEUTRALINO NO CARGADO - Ejecuta "neu update" en tu proyecto');
                document.body.innerHTML = '<div style="padding: 40px; text-align: center; font-family: sans-serif;">' +
                    '<h1 style="color: #ef4444;">‚ö†Ô∏è Error de Configuraci√≥n</h1>' +
                    '<p style="font-size: 18px; margin: 20px 0;">La biblioteca de Neutralino no est√° cargada.</p>' +
                    '<p style="font-size: 16px; color: #64748b;">Por favor ejecuta los siguientes comandos:</p>' +
                    '<pre style="background: #f1f5f9; padding: 20px; border-radius: 8px; text-align: left; max-width: 600px; margin: 20px auto;">' +
                    'cd mi-app\n' +
                    'neu update\n' +
                    'neu run' +
                    '</pre>' +
                    '</div>';
            }
        });
    </script>
</body>
</html>